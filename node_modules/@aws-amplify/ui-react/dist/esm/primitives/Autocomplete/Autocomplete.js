import{__rest as e}from"tslib";import o from"classnames";import*as t from"react";import{AutocompleteOption as n}from"./AutocompleteOption.js";import{AutocompleteMenu as a}from"./AutocompleteMenu.js";import{useAutocomplete as l}from"./useAutocomplete.js";import{HighlightMatch as i}from"../HighlightMatch/HighlightMatch.js";import{SearchField as s}from"../SearchField/SearchField.js";import{View as r}from"../View/View.js";import{isFunction as c}from"../shared/utils.js";import{ComponentClassNames as u}from"../shared/constants.js";const m=(m,d)=>{var{className:p,defaultValue:h,value:f,isLoading:C=!1,menuSlots:O={},options:g,optionFilter:b,onBlur:v,onChange:I,onClear:S,onClick:j,onFocus:F,onSelect:M,onSubmit:k,renderOption:w,testId:A}=m,B=e(m,["className","defaultValue","value","isLoading","menuSlots","options","optionFilter","onBlur","onChange","onClear","onClick","onFocus","onSelect","onSubmit","renderOption","testId"]);const{activeOptionId:V,autocompleteId:x,composedValue:y,filteredOptions:E,handleOnBlur:D,handleOnClear:N,handleOnClick:L,handleOnFocus:H,handleOnChange:K,handleOnKeyDown:$,isControlled:q,isCustomFiltering:R,isMenuOpen:z,listboxId:G,menuId:J,optionBaseId:P,setActiveOption:Q,setIsMenuOpen:T,setInternalValue:U}=l({defaultValue:h,value:f,options:g,optionFilter:b,onBlur:v,onChange:I,onClear:S,onClick:j,onFocus:F,onSelect:M,onSubmit:k}),W={role:"combobox","aria-activedescendant":V,"aria-autocomplete":"list","aria-controls":z?J:void 0,"aria-expanded":z,"aria-haspopup":"listbox","aria-owns":z?J:void 0},X=E.map(((o,a)=>{const{id:l,label:s}=o,r=e(o,["id","label"]),u=null!=l?l:`${P}-option-${a}`,m=u===V;return t.createElement(n,Object.assign({isActive:m,id:u,key:u,onClick:()=>{T(!1),Q(null),q||U(s),c(M)&&M(o)},onMouseDown:e=>{e.preventDefault()},onMouseMove:()=>{Q(o)}},r),c(w)?w(o,y):R?s:t.createElement(i,{query:y},s))}));return t.createElement(r,{className:o(u.Autocomplete,p),id:x,testId:A},t.createElement(s,Object.assign({hasSearchButton:!1,hasSearchIcon:!0,onBlur:D,onChange:K,onClear:N,onClick:L,onFocus:H,onKeyDown:$,ref:d,value:y},W,B)),z?t.createElement(a,Object.assign({id:J,isLoading:C,listboxId:G},O),X):null)},d=t.forwardRef(m);d.displayName="Autocomplete";export{d as Autocomplete,m as AutocompletePrimitive};
